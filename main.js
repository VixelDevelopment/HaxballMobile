const e=document.querySelector(".gameframe").contentWindow;let t=document.createElement("style");e.document.head.appendChild(t);let n=document.querySelector(".gameframe").contentWindow.document.body;document.querySelector("meta[name=viewport]").setAttribute("content","width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=0");const o=!0,i=!0,a=!0,c={url:"https://seeklogo.com/images/A/argentine-football-association-afa-2018-logo-BDF55D25F3-seeklogo.com.png",height:"100px"},l={name:"Inter",type:"sans-serif",url:"https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap"};new MutationObserver((function(e,t){e.forEach((e=>{"childList"===e.type&&(r("loader-view")||(n.querySelector(".roomlist-view")?(r("search")||function(){if(void 0!==o){const e=document.createElement("div");e.className="label-input",e.style.backgroundColor="transparent",e.style.padding="0",e.innerHTML='<label>Search a room:</label><br><input data-hook="search" placeholder="Type here..." type="text">';d(n.querySelector("div.dialog>p:nth-child(2)"),e);const t=e.querySelector("input");t.addEventListener("input",(function(){s(t.value)}))}}(),r("url-room")||function(){if(void 0!==i){let e=document.createElement("button");e.setAttribute("data-hook","url-room"),e.innerHTML='<i class="icon-link"></i><div>Paste Room</div>',e.addEventListener("click",(function(){navigator.clipboard.readText().then((e=>function(e){const t=e.replace(/^https?:\/\/(www\.)?haxball\.com\/play\?c=/,"");t.length>0&&window.location.replace("https://www.haxball.com/play?c="+t)}(e)),(e=>console.log(e)))})),d(r("join"),e)}}(),s(r("search").value)):n.querySelector(".room-view")&&(r("store")||function(){if(void 0!==a){let e=document.createElement("button");e.setAttribute("data-hook","store"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 407 407" fill="white" style="height:0.85em; width: auto"><path d="M402 84 323 5c-3-3-7-5-12-5H17C8 0 0 8 0 17v373c0 9 8 17 17 17h373c9 0 17-8 17-17V96c0-4-2-9-5-12zm-101 80H67V39h234v125z"></path><path d="M214 148h43c3 0 6-2 6-6V60c0-4-3-6-6-6h-43c-3 0-6 2-6 6v82c0 4 3 6 6 6z"></path></svg> Store',d(r("rec-btn"),e),e.addEventListener("click",(function(){!function(e){const t=n.querySelector(".chatbox-view").querySelector("input");t.focus(),t.value=e,t.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0,keyCode:13,which:13}))}("/store")}))}}(),n.querySelector(".room-view .admin")&&n.querySelectorAll(".player-list-item").forEach((function(e){let t;e.addEventListener("touchstart",(function(n){var o;1===n.touches.length&&(t&&n.timeStamp<=t?(n.preventDefault(),o=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,view:window,button:2}),e.dispatchEvent(o),t=null):t=n.timeStamp+400)}))})))))}))})).observe(n,{childList:!0,subtree:!0}),document.querySelector(".rightbar").remove();{let y=document.createElement("link");y.href="https://raw.githubusercontent.com/VixelDevelopment/HaxballMobile/main/custom.css",y.rel="stylesheet",y.type="text/css",e.document.head.appendChild(y)}if(void 0!==l){let v=document.createElement("link");v.href=l.url,v.rel="stylesheet",e.document.head.appendChild(v),t.innerHTML+=`* {font-family: '${l.name}', ${l.type} !important;}`}function s(e){if(void 0!==o){const t=e;n.querySelectorAll("tr").forEach((e=>{const n=e.querySelector('span[data-hook="name"]');n&&!n.textContent.toLowerCase().includes(t)?e.style.display="none":e.removeAttribute("style")}))}}function r(e){return n.querySelector('[data-hook="'+e+'"]')}function d(e,t){e.parentNode.insertBefore(t,e.nextSibling)}void 0!==c&&(t.innerHTML+=`.choose-nickname-view>img {content: url("${c.url}");height:${c.height||"auto"};width:${c.width||"auto"}}`),document.querySelector(".header").remove();{const f=document.createElement("div"),b=document.createElement("div"),w=document.createElement("div");f.setAttribute("id","joystick"),b.setAttribute("id","joystick-panel"),w.setAttribute("id","stick"),f.style.visibility="hidden",document.body.appendChild(b),b.appendChild(f),f.appendChild(w);let g=document.createElement("style");g.innerHTML=":root {\n                                        --joystick-size: 30vh;\n                                        --joystick-opacity: 1\n                                    }\n\n                                    #joystick,\n                                    #stick {\n                                        touch-action: none;\n                                        background-color:#c2c2c255;\n                                        box-shadow:6px 6px 10px 0 #a5abb133,-5px -5px 9px 0 #a5abb133;\n                                        color:#dedede55;\n                                        font-weight:bolder;\n                                        font-size:1.5rem;\n                                        border-radius: 50%;\n                                    }\n\n                                    #joystick {\n                                        width: var(--joystick-size);\n                                        height: var(--joystick-size);\n                                        opacity: var(--joystick-opacity);\n                                        position: absolute;\n                                        left: 0;\n                                        bottom: 0;\n                                    }\n\n                                    #joystick-panel {\n                                        width: 30%;\n                                        height: 100%;\n                                        position: absolute;\n                                        left: 0;\n                                        bottom: 0;\n                                    }\n\n                                    #stick {\n                                        width: calc(var(--joystick-size) * .45);\n                                        height: calc(var(--joystick-size) * .45);\n                                        position: absolute;\n                                        top: 50%;\n                                        left: 50%;\n                                        transform: translate(-50%, -50%)\n                                    }",document.head.appendChild(g);let k,E=!1;let x={W:0,A:0,S:0,D:0};const M=1/40*1e3;let S=M*x,L=M-S;function u(e){E=!0;const t=f.getBoundingClientRect();let n=e.touches[0].clientX-t.left,o=e.touches[0].clientY-t.top;n-=f.offsetWidth/2,o-=f.offsetHeight/2,f.style.transform=`translate(${n}px,${o}px)`,f.style.visibility="visible",e.preventDefault()}function h(e){E=!1,f.style.transform="",f.style.visibility="hidden",w.style.transition="transform 0.1s ease-out",w.style.transform="translate(-50%, -50%)",k=0,x.W=0,x.A=0,x.S=0,x.D=0}function m(e){if(!E)return;const t=f.getBoundingClientRect();w.getBoundingClientRect();let n=e.clientX-t.left,o=e.clientY-t.top;"touchmove"===e.type&&(n=e.touches[0].clientX-t.left,o=e.touches[0].clientY-t.top);const i=f.offsetWidth/2,a=f.offsetHeight/2;let c=(n-i)/(f.offsetWidth/2),l=(o-a)/(f.offsetHeight/2);c=Math.min(1,Math.max(-1,c)),l=Math.min(1,Math.max(-1,l));let s=Math.atan2(o-a,n-i)*(180/Math.PI),r=Math.min(f.offsetWidth/2,Math.sqrt(Math.pow(n-i,2)+Math.pow(o-a,2)));w.style.transition="none",w.style.transform=`translate(${r*Math.cos(s*(Math.PI/180))-i/2}px, ${r*Math.sin(s*(Math.PI/180))-a/2}px)`,x.D=c,x.A=-1*c,x.S=l,x.W=-1*l}function p(t){S=M*x[t],L=M-S,x[t]>.05&&e.document.dispatchEvent(new KeyboardEvent("keydown",{code:"Key"+[t]})),setTimeout((()=>{x[t]<.85&&e.document.dispatchEvent(new KeyboardEvent("keyup",{code:"Key"+[t]})),setTimeout((function(){p(t)}),L)}),S)}b.addEventListener("mousedown",u),b.addEventListener("touchstart",u),b.addEventListener("mouseup",h),b.addEventListener("touchend",h),b.addEventListener("mousemove",m),b.addEventListener("touchmove",m),p("W"),p("A"),p("S"),p("D")}
